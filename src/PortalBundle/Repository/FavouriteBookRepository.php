<?php

namespace PortalBundle\Repository;

/**
 * FavouriteRepository
 *
 * This class was generated by the Doctrine ORM. Add your own custom
 * repository methods below.
 */
class FavouriteBookRepository extends \Doctrine\ORM\EntityRepository
{

	public function showFavouriteBooks($readerId) {
		$favouriteBooks = $this->getEntityManager()->createQuery(
			"SELECT 
					r.id,
					b.id AS id, 
					b.title AS title,
					b.imageName AS imageName,					
					a.id AS authorId,					
					a.name AS authorName   
			 FROM PortalBundle:Reader r 
			 JOIN r.favouriteBooks f
			 JOIN f.book b			 
			 JOIN b.author a
			 WHERE r.id = $readerId			 
			 ORDER BY b.addDate DESC"
		)->getResult();

		return $favouriteBooks;
	}

}
